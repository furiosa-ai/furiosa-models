# Model object

An `Model` object represents a neural network model in `furiosa-model`. 
This document explains what [`Model`][furiosa.registry.Model] object is, 
how you can access model artifacts and metadata, and usages.

## Loading a model
To load a pre-trained neural-network model, you need to call as the following.
Since the sizes of model images vary from tens to hundreds megabytes, 
fetching a pre-trained model takes some time (usually few seconds).
So, we provide two versions of APIs, blocking API and non-blocking API. 
Non-blocking API will be useful if your application uses asynchronous executors.

=== "Blocking API"
    ```python
    --8<-- "docs/examples/loading_model.py"
    ```

=== "Non-blocking API"
    ```python
    --8<-- "docs/examples/loading_model_nonblocking.py"
    ```

## Accessing artifacts and metadata
A model object includes model artifacts, such as ONNX, tflite, DFG, and ENF. 
DFG and ENF are binary program formats 
generated by [FuriosaAI Compiler](https://furiosa-ai.github.io/docs/latest/en/software/compiler.html).
In addition, a model object has various metadata. The followings are all attributes belong to 
a single model object.

### `furiosa.registry.Model`
::: furiosa.registry.Model
    options:
        show_root_heading: false
        show_bases: false
        show_source: false
 

## Creating a session (with a compilation)
To load a model to FuriosaAI NPU, you need to create a session instance with a specific model artifact 
through Furiosa SDK. As we mentioned above, even a single model instance has multiple model artifacts 
from a ONNX model to a pre-compiled binary called ENF.

By default, the session API uses the ENF (pre-compiled program binary) of the `Model` instance 
to reduce the model compilation time. 
However, when you want to compile a model with a custom compiler configuration, you need to compile 
from a ONNX model. The following codes show two examples:

=== "Using ENF binary"
    ```python
    --8<-- "docs/examples/ssd_mobilenet.py"
    ```

=== "Using ONNX model"
    ```python
    --8<-- "docs/examples/ssd_mobilenet_onnx.py"
    ```

If you want to learn more about various options and features of Session API, 
please refer to [Furiosa SDK - Tutorial and Code Examples](https://furiosa-ai.github.io/docs/latest/en/software/tutorials.html).

# See Also
* [Furiosa SDK Documentation](https://furiosa-ai.github.io/docs/latest/en/)